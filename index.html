<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<!-- <script src="https://telegram.org/js/telegram-web-app.js"></script> -->

<script src="https://telegram.org/js/telegram-web-app.js">
var userId = window.Telegram.WebApp.initDataUnsafe.user.id;
      var textField = document.getElementById('telegramIdField');
      textField.textContent = userId;
  
document.addEventListener('DOMContentLoaded', function() {
    // Расширение веб-приложения Telegram, если доступно
    if (window.Telegram && window.Telegram.WebApp) {
        window.Telegram.WebApp.expand();
    }
  }


  function showMyId(){
    var userId = window.Telegram.WebApp.initDataUnsafe.user.id;
      var textField = document.getElementById('telegramIdField');
      textField.textContent = userId;

  }


  

    function consolePrint() {
      let task = document.getElementById("task").value;
      let tlgid = document.getElementById("tlgid").value;
      console.log(task+tlgid)
    }

    function addParagraph() {
      // Создаем новый элемент абзаца
      var paragraph = document.createElement('p');

      // Создаем текстовый узел для абзаца
      var textNode = document.createTextNode('Пример текста в абзаце');

      // Добавляем текстовый узел в элемент абзаца
      paragraph.appendChild(textNode);

      // Находим элемент, в который мы хотим добавить абзац (например, body)
      var container = document.body;

      // Добавляем элемент абзаца в контейнер
      container.appendChild(paragraph);

    }

    function showMyTasks(){
      fetch('https://66256060052332d5531fecfe.mockapi.io/tasks')
      .then(response => {
       if (!response.ok) {
       throw new Error('Network response was not ok');
      }
      return response.json();
      })
      .then(data => {
        var length = data.length;
        for (i=0; i < length ; i++){
          if(data[i].tlg_is==100){
          console.log(data[i].taskName)

           // Создаем новый элемент абзаца
           var paragraph = document.createElement('p');
          // Создаем текстовый узел для абзаца
          var textNode = document.createTextNode(data[i].taskName);
          // Добавляем текстовый узел в элемент абзаца
          paragraph.appendChild(textNode);
          // Находим элемент, в который мы хотим добавить абзац (например, body)
          var container = document.body;
          // Добавляем элемент абзаца в контейнер
          container.appendChild(paragraph);

          }
        }
        
      })
      .catch(error => {
       console.error('There was a problem with the fetch operation:', error);
      });

      }

    

    function CreateTask() {
      let task = document.getElementById("task").value;
      let tlgid = document.getElementById("tlgid").value;   

    // Формирование данных, для отправки в БД по fetch 
    const dataToBeSent = {
      tlg_is: tlgid,
      taskName: task,
      id: ""
    }

    fetch('https://66256060052332d5531fecfe.mockapi.io/tasks', {
      method: 'POST', 
      body: JSON.stringify(dataToBeSent), 
      headers: {
        'Content-type': 'application/json; charset=UTF-8',
      },
    })
      .then((response) => response.json())
      .then((data) => {
      console.log(data)
      })
  
     }
  
    
);
</script>


  

<body>

<div class="container">
    
    <div>My id3:</div><span id="telegramIdField">123</span>
  
    <div class="name">
      <div class="label">Текст задачи</div>
      <div><input type="text" id="task" name="nameInput" class="task"></div>
    </div>

    <div class="name">
      <div class="label">Телеграм ID</div>
      <div><input type="text" id="tlgid" name="nameInput" class="tlgid"></div>
    </div>
  
  
    <div class="buttonsdown">
      <div><button onclick="showMyTasks()">Покажи мои задачи</button> </div>

      <div class="buttonsdown">
        <div><button onclick="showMyId()">showMyId 4</button> </div>
        
  
  </div> 
</body>

</html>  

  
  

  



  
